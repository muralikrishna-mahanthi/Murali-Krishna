<section class="image-banner image-banner--{{ section.id }}">
  <div class="image-banner__media">
    {% if section.settings.mobile_image != blank %}
      <picture>
        <source media="(max-width: 767px)" srcset="{{ section.settings.mobile_image | image_url: width: 900 }}">
        {% if section.settings.desktop_image != blank %}
          <img
            class="image-banner__img"
            src="{{ section.settings.desktop_image | image_url: width: 2200 }}"
            alt="{{ section.settings.desktop_image.alt | escape }}"
            loading="lazy"
            width="{{ section.settings.desktop_image.width }}"
            height="{{ section.settings.desktop_image.height }}"
          >
        {% else %}
          <img
            class="image-banner__img"
            src="{{ section.settings.mobile_image | image_url: width: 2200 }}"
            alt="{{ section.settings.mobile_image.alt | escape }}"
            loading="lazy"
            width="{{ section.settings.mobile_image.width }}"
            height="{{ section.settings.mobile_image.height }}"
          >
        {% endif %}
      </picture>
    {% elsif section.settings.desktop_image != blank %}
      <img
        class="image-banner__img"
        src="{{ section.settings.desktop_image | image_url: width: 2200 }}"
        alt="{{ section.settings.desktop_image.alt | escape }}"
        loading="lazy"
        width="{{ section.settings.desktop_image.width }}"
        height="{{ section.settings.desktop_image.height }}"
      >
    {% else %}
      {{ 'lifestyle-2' | placeholder_svg_tag: 'image-banner__img image-banner__img--placeholder' }}
    {% endif %}
    <div class="image-banner__overlay"></div>
  </div>

  <div class="image-banner__content image-banner__content--{{ section.settings.content_position }}">
    <div class="image-banner__card js-banner-reveal">
      {% if section.settings.eyebrow != blank %}
        <p class="image-banner__eyebrow">{{ section.settings.eyebrow }}</p>
      {% endif %}

      {% if section.settings.heading != blank %}
        <h2 class="image-banner__heading">{{ section.settings.heading }}</h2>
      {% endif %}

      {% if section.settings.text != blank %}
        <div class="image-banner__text">{{ section.settings.text }}</div>
      {% endif %}

      {% if section.settings.button_label != blank and section.settings.button_link != blank %}
        <a class="image-banner__button" href="{{ section.settings.button_link }}">
          <span>{{ section.settings.button_label }}</span>
          <span aria-hidden="true">â†’</span>
        </a>
      {% endif %}
    </div>
  </div>
</section>

<style>
  .image-banner--{{ section.id }} {
    --banner-height-desktop: {{ section.settings.height_desktop }}vh;
    --banner-height-mobile: {{ section.settings.height_mobile }}vh;
    --overlay-opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    --overlay-color: {{ section.settings.overlay_color }};
    --card-bg: {{ section.settings.card_bg }};
    --heading-color: {{ section.settings.heading_color }};
    --text-color: {{ section.settings.text_color }};
    --button-bg: {{ section.settings.button_bg }};
    --button-text: {{ section.settings.button_text }};
    position: relative;
    overflow: hidden;
  }

  .image-banner--{{ section.id }} .image-banner__media,
  .image-banner--{{ section.id }} .image-banner__content {
    min-height: var(--banner-height-desktop);
  }

  .image-banner--{{ section.id }} .image-banner__media {
    position: absolute;
    inset: 0;
  }

  .image-banner--{{ section.id }} .image-banner__img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .image-banner--{{ section.id }} .image-banner__overlay {
    position: absolute;
    inset: 0;
    background: var(--overlay-color);
    opacity: var(--overlay-opacity);
  }

  .image-banner--{{ section.id }} .image-banner__content {
    position: relative;
    z-index: 2;
    display: grid;
    padding: clamp(20px, 4vw, 60px);
  }

  .image-banner--{{ section.id }} .image-banner__content--left {
    justify-items: start;
    align-items: center;
  }

  .image-banner--{{ section.id }} .image-banner__content--center {
    justify-items: center;
    align-items: center;
  }

  .image-banner--{{ section.id }} .image-banner__content--right {
    justify-items: end;
    align-items: center;
  }

  .image-banner--{{ section.id }} .image-banner__card {
    width: min(100%, 640px);
    background: var(--card-bg);
    padding: clamp(20px, 3vw, 36px);
    border-radius: 14px;
    box-shadow: 0 14px 40px rgba(0, 0, 0, 0.2);
    opacity: 0;
    transform: translateY(16px);
    transition: opacity 0.5s ease, transform 0.5s ease;
  }

  .image-banner--{{ section.id }} .image-banner__card.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .image-banner--{{ section.id }} .image-banner__eyebrow {
    margin: 0 0 10px;
    color: var(--text-color);
    font-size: 13px;
    letter-spacing: 1.8px;
    text-transform: uppercase;
  }

  .image-banner--{{ section.id }} .image-banner__heading {
    margin: 0 0 12px;
    color: var(--heading-color);
    font-size: clamp(30px, 5vw, 58px);
    line-height: 1.06;
  }

  .image-banner--{{ section.id }} .image-banner__text {
    margin: 0;
    color: var(--text-color);
    font-size: clamp(15px, 2vw, 19px);
    line-height: 1.5;
  }

  .image-banner--{{ section.id }} .image-banner__button {
    margin-top: 20px;
    display: inline-flex;
    align-items: center;
    gap: 10px;
    background: var(--button-bg);
    color: var(--button-text);
    text-decoration: none;
    padding: 12px 20px;
    border-radius: 999px;
    font-weight: 600;
    transition: transform 0.2s ease, opacity 0.2s ease;
  }

  .image-banner--{{ section.id }} .image-banner__button:hover {
    transform: translateY(-1px);
    opacity: 0.95;
  }

  @media (max-width: 767px) {
    .image-banner--{{ section.id }} .image-banner__media,
    .image-banner--{{ section.id }} .image-banner__content {
      min-height: var(--banner-height-mobile);
    }

    .image-banner--{{ section.id }} .image-banner__content {
      align-items: end;
      padding: 16px;
    }

    .image-banner--{{ section.id }} .image-banner__card {
      width: 100%;
      border-radius: 12px;
      padding: 18px;
    }

    .image-banner--{{ section.id }} .image-banner__button {
      width: 100%;
      justify-content: center;
    }
  }
</style>

<script>
  (function() {
    var sectionRoot = document.querySelector('.image-banner--{{ section.id }}');
    if (!sectionRoot) return;

    var card = sectionRoot.querySelector('.js-banner-reveal');
    if (!card) return;

    var observer = new IntersectionObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          card.classList.add('is-visible');
          observer.unobserve(card);
        }
      });
    }, { threshold: 0.25 });

    observer.observe(card);
  })();
</script>

{% schema %}
{
  "name": "New Image Banner",
  "settings": [
    { "type": "image_picker", "id": "desktop_image", "label": "Desktop image" },
    { "type": "image_picker", "id": "mobile_image", "label": "Mobile image" },

    { "type": "range", "id": "height_desktop", "label": "Desktop height (vh)", "min": 40, "max": 100, "step": 5, "default": 80 },
    { "type": "range", "id": "height_mobile", "label": "Mobile height (vh)", "min": 40, "max": 100, "step": 5, "default": 70 },

    {
      "type": "select",
      "id": "content_position",
      "label": "Content position",
      "default": "left",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ]
    },

    { "type": "text", "id": "eyebrow", "label": "Eyebrow", "default": "Limited Collection" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "New Season Banner" },
    { "type": "textarea", "id": "text", "label": "Text", "default": "Build your own responsive Shopify banner with editable content for desktop and mobile." },

    { "type": "text", "id": "button_label", "label": "Button label", "default": "Shop Now" },
    { "type": "url", "id": "button_link", "label": "Button link" },

    { "type": "color", "id": "overlay_color", "label": "Overlay color", "default": "#000000" },
    { "type": "range", "id": "overlay_opacity", "label": "Overlay opacity", "min": 0, "max": 90, "step": 5, "default": 30 },

    { "type": "color", "id": "card_bg", "label": "Content card background", "default": "#ffffff" },
    { "type": "color", "id": "heading_color", "label": "Heading color", "default": "#111111" },
    { "type": "color", "id": "text_color", "label": "Text color", "default": "#222222" },
    { "type": "color", "id": "button_bg", "label": "Button background", "default": "#111111" },
    { "type": "color", "id": "button_text", "label": "Button text", "default": "#ffffff" }
  ],
  "presets": [
    {
      "name": "New Image Banner"
    }
  ]
}
{% endschema %}
